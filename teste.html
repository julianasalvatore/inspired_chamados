<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abertura de Chamado - Suporte TI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f4f7;
    padding: 20px;
}
.container {
    max-width: 800px;
    background: #fff;
    padding: 25px;
    margin: auto;
    border-radius: 8px;
}
h2 { text-align: center; }
label { font-weight: bold; margin-top: 15px; display: block; }
select, textarea, input, button {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
}
textarea { resize: vertical; }
button {
    background: #0d6efd;
    color: #fff;
    border: none;
    cursor: pointer;
    margin-top: 20px;
}
button:hover { background: #084298; }
.review {
    display: none;
    background: #eef1f5;
    padding: 15px;
    border-radius: 6px;
    margin-top: 20px;
}
pre { white-space: pre-wrap; }
</style>
</head>

<body>
<div class="container">

<h2>Abertura de Chamado – Suporte TI</h2>

<!-- PERFIL -->
<label>Você é:</label>
<select id="perfil" onchange="controlePerfil()">
    <option value="">Selecione</option>
    <option value="Aluno">Aluno</option>
    <option value="Colaborador">Colaborador</option>
</select>

<!-- UNIDADE -->
<label>Unidade:</label>
<select id="unidade" onchange="controleUnidade()">
    <option value="">Selecione</option>
</select>

<!-- CAMPOS ALUNO -->
<div id="camposAluno" style="display:none;">
    <label>Sala:</label>
    <select id="salaAluno"></select>

    <label>Turma:</label>
    <input id="turmaAluno">
</div>

<!-- CAMPOS COLABORADOR -->
<div id="camposColaborador" style="display:none;">
    <label>Setor:</label>
    <select id="setor"></select>

    <div id="blocoSalaColab">
        <label>Sala para atendimento:</label>
        <select id="salaColab"></select>
    </div>
</div>

<!-- EQUIPAMENTO -->
<label>Equipamento / Solicitação:</label>
<select id="equipamento" onchange="atualizarSubProblema()">
    <option value="">Selecione</option>
    <option>Notebook / Laptop</option>
    <option>Carregador de notebook</option>
    <option>Mouse</option>
    <option>Teclado</option>
    <option>Kit Mouse + Teclado</option>
    <option>Headset</option>
    <option>Pilha AA - Média</option>
    <option>Pilha AAA - Palito</option>
    <option>Monitor</option>
    <option>Impressora</option>
    <option>Internet / Rede</option>
    <option>Pacote Office</option>
    <option>Programa específico para o setor</option>
    <option>Suporte para laptop / notebook</option>
</select>

<label>Problema relacionado:</label>
<select id="subproblema"></select>

<label>Descrição detalhada (opcional):</label>
<textarea id="descricao" rows="4"></textarea>

<button onclick="gerarRevisao()">Revisar Chamado</button>

<div class="review" id="revisao">
    <h3>Revisão do Chamado</h3>
    <pre id="resumo"></pre>
    <button onclick="enviarEmail()">Confirmar e Abrir Chamado</button>
</div>

</div>

<script>
const unidadesEscolares = [
    "Os Batutinhas","Colégio Leonardo Da Vinci","Eleva Botafogo","Eleva Urca",
    "Eleva Barra da Tijuca","Eleva Recife","Eleva Brasília","Eleva São Paulo",
    "Gurilândia Federação","Gurilândia Pituba","Land School Federação","Land School Pituba"
];

function gerarSequencia(prefixo, inicio, fim) {
    return Array.from({length: fim - inicio + 1}, (_, i) =>
        prefixo + String(inicio + i).padStart(2, "0")
    );
}

function salasPorUnidade(unidade) {
    if (unidade === "Eleva Recife") {
        return [
            ...gerarSequencia("A",1,9),
            ...gerarSequencia("B",1,22),
            ...gerarSequencia("C",1,10),
            "EAL","LAB01","LAB02","MAKER","ARTS",
            ...gerarSequencia("D",1,13),
            "DANÇA","MUSIC01","MUSIC02"
        ];
    }

    if (unidade === "Eleva Brasília") {
        return [
            "Música","Drama","Artes",
            ...gerarSequencia("A",1,20),"Maker Space",
            ...gerarSequencia("B",1,20),
            "Lab Química","Lab Física"
        ];
    }

    return [];
}

function controlePerfil() {
    unidade.innerHTML = "<option value=''>Selecione</option>";

    if (perfil.value === "Aluno") {
        unidadesEscolares.forEach(u => unidade.innerHTML += `<option>${u}</option>`);
        camposAluno.style.display = "block";
        camposColaborador.style.display = "none";
    }

    if (perfil.value === "Colaborador") {
        unidade.innerHTML += "<option>Head Office Brazil</option>";
        unidadesEscolares.forEach(u => unidade.innerHTML += `<option>${u}</option>`);
        camposAluno.style.display = "none";
        camposColaborador.style.display = "block";
    }
}

function preencherSalas(selectSala, unidade) {
    selectSala.innerHTML = "<option value=''>Selecione</option>";
    salasPorUnidade(unidade).forEach(s =>
        selectSala.innerHTML += `<option>${s}</option>`
    );
}

function controleUnidade() {
    setor.innerHTML = "";
    salaAluno.innerHTML = "";
    salaColab.innerHTML = "";
    blocoSalaColab.style.display = "block";

    if (perfil.value === "Aluno") {
        preencherSalas(salaAluno, unidade.value);
        return;
    }

    if (perfil.value === "Colaborador") {
        let setores = unidade.value === "Head Office Brazil"
            ? ["Admissões","Administração","Finanças","Jurídico","Marketing","Operações",
               "Pedagógico / Enhancement","RH - Recursos Humanos","TI - Tecnologia da Informação"]
            : ["Professor","Coordenação","Operações","Administração","Diretoria","Secretaria"];

        setores.forEach(s => setor.innerHTML += `<option>${s}</option>`);

        if (unidade.value === "Head Office Brazil") {
            blocoSalaColab.style.display = "none";
        } else {
            preencherSalas(salaColab, unidade.value);
        }
    }
}

function atualizarSubProblema() {
    const mapa = {
        "Notebook / Laptop": ["Não liga","Tela","Teclado","Bateria","Sistema"],
        "Carregador de notebook": ["Não carrega","Cabo danificado"],
        "Mouse": ["Não funciona","Sem pilha","Conexão"],
        "Teclado": ["Teclas falhando","Não funciona"],
        "Kit Mouse + Teclado": ["Mouse","Teclado","Ambos"],
        "Headset": ["Sem áudio","Microfone","Conexão"],
        "Monitor": ["Sem imagem","Cabo","Resolução"],
        "Impressora": ["Não imprime","Erro","Papel preso","Rede"],
        "Internet / Rede": [
            "Não conecta à rede corporativa",
            "Não conecta à EE-Students",
            "Ativar Rede Eventos (informar data/horário)"
        ],
        "Pacote Office": ["Instalação","Licença","Erro"],
        "Programa específico para o setor": ["Instalação","Erro","Acesso"],
        "Suporte para laptop / notebook": ["Configuração","Atualização","Manutenção"]
    };

    subproblema.innerHTML = "";
    (mapa[equipamento.value] || ["Outro"]).forEach(p =>
        subproblema.innerHTML += `<option>${p}</option>`
    );
}

function gerarRevisao() {
    if (!perfil.value || !unidade.value || !equipamento.value) {
        alert("Preencha os campos obrigatórios.");
        return;
    }

    resumo.textContent =
`Perfil: ${perfil.value}
Unidade: ${unidade.value}
Sala: ${perfil.value === "Aluno" ? salaAluno.value : salaColab.value || "N/A"}
Equipamento: ${equipamento.value}
Problema: ${subproblema.value}
Descrição: ${descricao.value || "Não informada"}`;

    revisao.style.display = "block";
}

function enviarEmail() {
    const subject = encodeURIComponent(`${unidade.value} – ${equipamento.value}`);
    const body = encodeURIComponent(resumo.textContent);

    window.open(
        "https://outlook.office.com/mail/deeplink/compose"
        + "?to=it.support@inspirededu.com"
        + "&subject=" + subject
        + "&body=" + body,
        "_blank"
    );
}
</script>

</body>
</html>
