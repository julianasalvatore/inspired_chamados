<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abertura de Chamado - Suporte TI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f4f7;
    padding: 20px;
}
.container {
    max-width: 900px;
    background: #fff;
    padding: 25px;
    margin: auto;
    border-radius: 8px;
}
h2 { text-align: center; }
label { font-weight: bold; margin-top: 15px; display: block; }
select, textarea, input, button {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
}
textarea { resize: vertical; }
button {
    background: #0d6efd;
    color: #fff;
    border: none;
    cursor: pointer;
    margin-top: 20px;
}
button:hover { background: #084298; }
.review {
    display: none;
    background: #eef1f5;
    padding: 15px;
    border-radius: 6px;
    margin-top: 20px;
}
pre { white-space: pre-wrap; }
</style>
</head>

<body>
<div class="container">

<h2>Abertura de Chamado – Suporte TI</h2>

<label>Você é:</label>
<select id="perfil" onchange="controlePerfil()">
    <option value="">Selecione</option>
    <option>Aluno</option>
    <option>Colaborador</option>
</select>

<label>E-mail institucional:</label>
<input type="email" id="email">

<label>Unidade:</label>
<select id="unidade" onchange="controleUnidade()">
    <option value="">Selecione</option>
</select>

<div id="blocoSala">
    <label>Sala:</label>
    <div id="containerSala"></div>
</div>

<div id="camposAluno" style="display:none;">
    <label>Turma:</label>
    <input id="turmaAluno">
</div>

<div id="camposColaborador" style="display:none;">
    <label>Setor:</label>
    <select id="setor"></select>
</div>

<label>Equipamento / Solicitação:</label>
<select id="equipamento"></select>

<label>Descrição detalhada do problema (opcional):</label>
<textarea id="descricao" rows="4"></textarea>

<button type="button" onclick="gerarRevisao()">Revisar Chamado</button>

<div class="review" id="revisao">
    <h3>Revisão do Chamado</h3>
    <pre id="resumo"></pre>
    <button type="button" onclick="enviarEmail()">Confirmar e Abrir Chamado</button>
</div>

</div>

<script>
const unidades = [
    "Head Office Brazil","Os Batutinhas","Colégio Leonardo Da Vinci","Eleva Botafogo",
    "Eleva Urca","Eleva Barra da Tijuca","Eleva Recife","Eleva Brasília","Eleva São Paulo",
    "Gurilândia Federação","Gurilândia Pituba","Land School Federação","Land School Pituba"
];

const equipamentosAluno = [
    "Computador","Chromebook","iPad","Internet","Carregador","Headset","Outro"
];

const equipamentosColaboradorBase = [
    "Mouse","Teclado","Kit Mouse + Teclado",
    "Monitor","Impressora","Internet / Rede",
    "Pacote Office","Programa específico para o setor"
];

const equipamentosExtras = [
    "Computador","Chromebook","Projetor","Som",
    "iPad","Impressora","Internet","Carregador",
    "Telefone","Headset","Outro"
];

function gerar(prefixo, ini, fim) {
    return Array.from({length:fim-ini+1},(_,i)=>prefixo+String(ini+i).padStart(2,"0"));
}

function salasPorUnidade(unidade) {
    if (unidade === "Eleva Botafogo") return [
        "LAB 01","LAB 02","LAB 03","LAB 04",
        ...gerar("B",1,36),...gerar("D",1,10),
        "Maker","Auditório Vermelho","Sala Multiuso"
    ];

    if (unidade === "Eleva Urca") return [
        ...Array.from({length:12},(_,i)=>`Bloco Praia - Sala ${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:9},(_,i)=>`Bloco Ruínas - Sala ${String(i+12).padStart(2,"0")}`)
    ];

    if (unidade === "Eleva Recife") return [
        ...gerar("A",1,9),...gerar("B",1,22),...gerar("C",1,10),
        "EAL","LAB01","LAB02","MAKER","ARTS",
        ...gerar("D",1,13),"DANÇA","MUSIC01","MUSIC02"
    ];

    if (unidade === "Eleva Brasília") return [
        "Música","Drama","Artes",
        ...gerar("A",1,20),"Maker Space",
        ...gerar("B",1,20),"Lab Química","Lab Física"
    ];

    if (unidade === "Eleva São Paulo") return [
        "Subsolo - Sala de Música",
        ...gerar("A",1,6),...gerar("B",1,3),
        ...gerar("C",1,13),...gerar("D",1,7),
        ...gerar("E",1,5),...gerar("F",1,5)
    ];

    if (unidade === "Eleva Barra da Tijuca") return [
        ...Array.from({length:15},(_,i)=>`Sala A-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:26},(_,i)=>`Sala B-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:10},(_,i)=>`Sala C-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:10},(_,i)=>`Sala D-${String(i+1).padStart(2,"0")}`)
    ];

    return null;
}

function controlePerfil() {
    unidade.innerHTML = "<option value=''>Selecione</option>";
    unidades.forEach(u => unidade.innerHTML += `<option>${u}</option>`);

    camposAluno.style.display = perfil.value==="Aluno"?"block":"none";
    camposColaborador.style.display = perfil.value==="Colaborador"?"block":"none";

    equipamento.innerHTML = "<option value=''>Selecione</option>";

    if (perfil.value==="Aluno") {
        equipamentosAluno.forEach(e=>equipamento.innerHTML+=`<option>${e}</option>`);
    } else {
        [...new Set([...equipamentosColaboradorBase, ...equipamentosExtras])]
            .forEach(e=>equipamento.innerHTML+=`<option>${e}</option>`);
    }
}

function controleUnidade() {
    containerSala.innerHTML = "";
    setor.innerHTML = "";

    if (unidade.value === "Head Office Brazil") {
        blocoSala.style.display = "none";

        [
            "Admissões","Administração","Finanças","Jurídico","Marketing",
            "Operações","Pedagógico/ Enhancement",
            "RH - Recursos Humanos","TI - Tecnologia da Informação"
        ].forEach(s=>setor.innerHTML+=`<option>${s}</option>`);
        return;
    }

    blocoSala.style.display = "block";

    const salas = salasPorUnidade(unidade.value);
    if (salas) {
        let html="<select id='sala'><option value=''>Selecione</option>";
        salas.forEach(s=>html+=`<option>${s}</option>`);
        containerSala.innerHTML=html+"</select>";
    } else {
        containerSala.innerHTML="<input id='sala'>";
    }

    if (perfil.value==="Colaborador") {
        ["Professor","Coordenação","Operações","Administração","Diretoria","Secretaria"]
            .forEach(s=>setor.innerHTML+=`<option>${s}</option>`);
    }
}

function extrairNome(email) {
    return email.split("@")[0].replace(/[._]/g," ")
        .replace(/\b\w/g,l=>l.toUpperCase());
}

function gerarRevisao() {
    const nome = extrairNome(email.value);
    const sala = document.getElementById("sala")?.value || "N/A";

    let texto =
`Perfil: ${perfil.value}
Nome: ${nome}
E-mail: ${email.value}
Unidade: ${unidade.value}`;

    if (unidade.value !== "Head Office Brazil") texto += `\nSala: ${sala}`;
    if (perfil.value==="Aluno") texto += `\nTurma: ${turmaAluno.value || "N/A"}`;
    else texto += `\nSetor: ${setor.value || "N/A"}`;

    texto += `
Equipamento: ${equipamento.value}
Descrição:
${descricao.value || "Não informada"}`;

    resumo.textContent = texto;
    revisao.style.display="block";
}

function enviarEmail() {
    const assunto = `${unidade.value} – ${equipamento.value} – ${extrairNome(email.value)}`;
    const corpo = encodeURIComponent(resumo.textContent);
    const emailUser = email.value.toLowerCase();

    if (perfil.value==="Aluno" || emailUser.endsWith("@escolaeleva.com.br")) {
        window.open(`https://mail.google.com/mail/?view=cm&to=it.support@inspirededu.com&su=${encodeURIComponent(assunto)}&body=${corpo}`,"_blank");
        return;
    }
    window.open(`https://outlook.office.com/mail/deeplink/compose?to=it.support@inspirededu.com&subject=${encodeURIComponent(assunto)}&body=${corpo}`,"_blank");
}
</script>

</body>
</html>
