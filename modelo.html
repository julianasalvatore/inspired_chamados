<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Abertura de Chamado - Suporte TI</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
    font-family: Arial, sans-serif;
    background: #f2f4f7;
    padding: 20px;
}
.container {
    max-width: 800px;
    background: #fff;
    padding: 25px;
    margin: auto;
    border-radius: 8px;
}
h2 { text-align: center; }
label { font-weight: bold; margin-top: 15px; display: block; }
select, textarea, input, button {
    width: 100%;
    padding: 10px;
    margin-top: 5px;
}
textarea { resize: vertical; }
button {
    background: #0d6efd;
    color: #fff;
    border: none;
    cursor: pointer;
    margin-top: 20px;
}
button:hover { background: #084298; }
.review {
    display: none;
    background: #eef1f5;
    padding: 15px;
    border-radius: 6px;
    margin-top: 20px;
}
pre { white-space: pre-wrap; }
</style>
</head>

<body>
<div class="container">

<h2>Abertura de Chamado ‚Äì Suporte TI</h2>

<label>Voc√™ √©:</label>
<select id="perfil" onchange="controlePerfil()">
    <option value="">Selecione</option>
    <option>Aluno</option>
    <option>Colaborador</option>
</select>

<label>E-mail institucional:</label>
<input type="email" id="email" required placeholder="nome.sobrenome@escolaeleva.com.br">

<label>Unidade:</label>
<select id="unidade" onchange="controleUnidade()">
    <option value="">Selecione</option>
</select>

<div id="camposAluno" style="display:none;">
    <label>Sala:</label>
    <input id="salaAluno">

    <label>Turma:</label>
    <input id="turmaAluno">
</div>

<div id="camposColaborador" style="display:none;">
    <label>Setor:</label>
    <select id="setor"></select>

    <div id="blocoSalaColab">
        <label>Sala para atendimento:</label>
        <div id="containerSalaColab"></div>
    </div>
</div>

<label>Equipamento / Solicita√ß√£o:</label>
<select id="equipamento">
    <option value="">Selecione</option>
    <option>Notebook / Laptop</option>
    <option>Carregador de notebook</option>
    <option>Mouse</option>
    <option>Teclado</option>
    <option>Kit Mouse + Teclado</option>
    <option>Headset</option>
    <option>Pilha AA - M√©dia</option>
    <option>Pilha AAA - Palito</option>
    <option>Monitor</option>
    <option>Impressora</option>
    <option>Internet / Rede</option>
    <option>Pacote Office</option>
    <option>Programa espec√≠fico para o setor</option>
    <option>Suporte para laptop / notebook</option>
</select>

<label>Descri√ß√£o detalhada do problema (opcional):</label>
<textarea id="descricao" rows="4"></textarea>

<button type="button" onclick="gerarRevisao()">Revisar Chamado</button>

<div class="review" id="revisao">
    <h3>Revis√£o do Chamado</h3>
    <pre id="resumo"></pre>
    <button type="button" onclick="enviarEmail()">Confirmar e Abrir Chamado</button>
</div>

</div>

<script>
const unidades = [
    "Os Batutinhas","Col√©gio Leonardo Da Vinci","Eleva Botafogo","Eleva Urca",
    "Eleva Barra da Tijuca","Eleva Recife","Eleva Bras√≠lia","Eleva S√£o Paulo",
    "Guril√¢ndia Federa√ß√£o","Guril√¢ndia Pituba","Land School Federa√ß√£o","Land School Pituba"
];

function gerar(prefixo, ini, fim) {
    return Array.from({length:fim-ini+1},(_,i)=>prefixo+String(ini+i).padStart(2,"0"));
}

function salasFixas(unidade) {
    if (unidade === "Eleva Recife") return [
        ...gerar("A",1,9),...gerar("B",1,22),...gerar("C",1,10),
        "EAL","LAB01","LAB02","MAKER","ARTS",
        ...gerar("D",1,13),"DAN√áA","MUSIC01","MUSIC02"
    ];
    if (unidade === "Eleva Bras√≠lia") return [
        "M√∫sica","Drama","Artes",
        ...gerar("A",1,20),"Maker Space",
        ...gerar("B",1,20),"Lab Qu√≠mica","Lab F√≠sica"
    ];
    if (unidade === "Eleva S√£o Paulo") return [
        "Sub-Solo - Sala de M√∫sica",
        ...gerar("A",1,6),...gerar("B",1,3),
        ...gerar("C",1,13),...gerar("D",1,7),
        ...gerar("E",1,5),...gerar("F",1,5)
    ];
    if (unidade === "Eleva Urca") return [
        ...Array.from({length:12},(_,i)=>`Bloco Praia - Sala ${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:9},(_,i)=>`Bloco Ru√≠nas - Sala ${String(i+12).padStart(2,"0")}`)
    ];
    if (unidade === "Eleva Barra da Tijuca") return [
        ...Array.from({length:15},(_,i)=>`Sala A-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:26},(_,i)=>`Sala B-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:10},(_,i)=>`Sala C-${String(i+1).padStart(2,"0")}`),
        ...Array.from({length:10},(_,i)=>`Sala D-${String(i+1).padStart(2,"0")}`)
    ];
    return null;
}

function controlePerfil() {
    unidade.innerHTML = "<option value=''>Selecione</option>";
    camposAluno.style.display = perfil.value==="Aluno"?"block":"none";
    camposColaborador.style.display = perfil.value==="Colaborador"?"block":"none";

    if (perfil.value==="Colaborador") unidade.innerHTML += "<option>Head Office Brazil</option>";
    unidades.forEach(u=>unidade.innerHTML+=`<option>${u}</option>`);
}

function controleUnidade() {
    setor.innerHTML = "";
    containerSalaColab.innerHTML = "";

    if (perfil.value!=="Colaborador") return;

    const setoresHO = ["Admiss√µes","Administra√ß√£o","Finan√ßas","Jur√≠dico","Marketing","Opera√ß√µes","Pedag√≥gico / Enhancement","RH - Recursos Humanos","TI - Tecnologia da Informa√ß√£o"];
    const setoresPadrao = ["Professor","Coordena√ß√£o","Opera√ß√µes","Administra√ß√£o","Diretoria","Secretaria"];
    (unidade.value==="Head Office Brazil"?setoresHO:setoresPadrao)
        .forEach(s=>setor.innerHTML+=`<option>${s}</option>`);

    if (unidade.value==="Head Office Brazil") {
        blocoSalaColab.style.display="none";
        return;
    }

    blocoSalaColab.style.display="block";
    const salas = salasFixas(unidade.value);

    if (salas) {
        let html="<select id='salaColab'><option value=''>Selecione</option>";
        salas.forEach(s=>html+=`<option>${s}</option>`);
        containerSalaColab.innerHTML=html+"</select>";
    } else {
        containerSalaColab.innerHTML="<input id='salaColab' placeholder='Informe a sala'>";
    }
}

/* üîπ EXTRAI NOME DO E-MAIL */
function extrairNome(email) {
    let nome = email.split("@")[0]
        .replace(/[._]/g, " ")
        .toLowerCase()
        .replace(/\b\w/g, l => l.toUpperCase());
    return nome;
}

function gerarRevisao() {
    if (!perfil.value || !email.value || !unidade.value || !equipamento.value) {
        alert("Preencha os campos obrigat√≥rios.");
        return;
    }

    const nomeSolicitante = extrairNome(email.value);
    const sala = perfil.value==="Aluno"
        ? salaAluno.value
        : document.getElementById("salaColab")?.value || "N/A";

    resumo.textContent =
`Nome do solicitante: ${nomeSolicitante}
Perfil: ${perfil.value}
E-mail: ${email.value}
Unidade: ${unidade.value}
Setor: ${setor.value || "N/A"}
Sala: ${sala}
Turma: ${turmaAluno.value || "N/A"}
Equipamento: ${equipamento.value}

Descri√ß√£o:
${descricao.value || "N√£o informada"}`;

    revisao.style.display="block";
}

function enviarEmail() {
    const nomeSolicitante = extrairNome(email.value);
    const assunto = `${unidade.value} ‚Äì ${equipamento.value} ‚Äì ${nomeSolicitante}`;

    window.open(
        "https://outlook.office.com/mail/deeplink/compose"
        + "?to=it.support@inspirededu.com"
        + "&subject=" + encodeURIComponent(assunto)
        + "&body=" + encodeURIComponent(resumo.textContent),
        "_blank"
    );
}
</script>

</body>
</html>
